{% extends 'base.html' %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="span4">
                <h1>Welcome {{lastfmuser.user.username}}!</h1>
                <div class="control-group">
                    <label class="control-label" for="date-select">Select Chart Date</label>
                    <div class="controls">
                        <div id="date-select">
                            
                        </div>
                    </div>
                </div>
            </div>
            <div class="span8">
                <canvas></canvas>
            </div>
        </div>
    </div>
{% endblock %}

{% block scripts %}
<script>
    function select_week(dateText, inst) {
        alert(dateText);
    }

    $.getJSON('{{root_url}}api/weeklychartlist/', function(data) {
        var max = 0;
        var min = 9007199254740992;
        for(var i in data.charts) {
            if(data.charts[i].start < min) {
                min = data.charts[i].start; 
            }
            if(data.charts[i].end > max) {
                max = data.charts[i].end;
            }
        }
       $('#date-select').datepicker({
           onSelect: select_week(),
           dateFormat : "@",
           maxDate : max,
           minDate : min
       });
</script>
{% endblock %}
